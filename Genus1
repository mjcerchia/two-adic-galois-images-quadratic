Candidates:={"7.42.1.a.1", "7.42.1.b.1", "7.56.1.a.1", "7.56.1.b.1", "7.84.1.a.1", "8.12.1.a.1", "8.12.1.b.1", "8.12.1.c.1", "8.12.1.d.1", "8.24.1.a.1", "8.24.1.b.1", "8.24.1.ba.1", "8.24.1.bb.1",
"8.24.1.bc.1", "8.24.1.bd.1", "8.24.1.be.1", "8.24.1.bf.1", "8.24.1.c.1", "8.24.1.d.1", "8.24.1.e.1", "8.24.1.f.1", "8.24.1.g.1", "8.24.1.h.1", "8.24.1.i.1", "8.24.1.j.1", "8.24.1.k.1", "8.24.1.l.1",
"8.24.1.m.1", "8.24.1.n.1", "8.24.1.o.1", "8.24.1.p.1", "8.24.1.q.1", "8.24.1.r.1", "8.24.1.s.1", "8.24.1.t.1", "8.24.1.u.1", "8.24.1.v.1", "8.24.1.w.1", "8.24.1.x.1", "8.24.1.y.1", "8.24.1.z.1",
"8.32.1.a.1", "8.32.1.b.1", "8.32.1.c.1", "8.32.1.d.1", "8.48.1.a.1", "8.48.1.b.1", "8.48.1.ba.1", "8.48.1.bb.1", "8.48.1.bc.1", "8.48.1.bd.1", "8.48.1.be.1", "8.48.1.bf.1", "8.48.1.bg.1", "8.48.1.bh.1",
"8.48.1.bh.2", "8.48.1.bi.1", "8.48.1.bj.1", "8.48.1.bk.1", "8.48.1.bl.1", "8.48.1.bm.1", "8.48.1.bn.1", "8.48.1.bo.1", "8.48.1.bp.1", "8.48.1.bq.1", "8.48.1.br.1", "8.48.1.bs.1", "8.48.1.bt.1",
"8.48.1.bu.1", "8.48.1.bv.1", "8.48.1.c.1", "8.48.1.d.1", "8.48.1.e.1", "8.48.1.e.2", "8.48.1.f.1", "8.48.1.g.1", "8.48.1.g.2", "8.48.1.h.1", "8.48.1.h.2", "8.48.1.i.1", "8.48.1.i.2", "8.48.1.j.1",
"8.48.1.k.1", "8.48.1.k.2", "8.48.1.l.1", "8.48.1.m.1", "8.48.1.m.2", "8.48.1.n.1", "8.48.1.o.1", "8.48.1.p.1", "8.48.1.q.1", "8.48.1.r.1", "8.48.1.s.1", "8.48.1.s.2", "8.48.1.t.1", "8.48.1.u.1",
"8.48.1.v.1", "8.48.1.w.1", "8.48.1.x.1", "8.48.1.y.1", "8.48.1.z.1", "8.96.1.a.1", "8.96.1.a.2", "8.96.1.b.1", "8.96.1.b.2", "8.96.1.c.1", "8.96.1.c.2", "8.96.1.d.1", "8.96.1.e.1", "8.96.1.e.2",
"8.96.1.f.1", "8.96.1.f.2", "8.96.1.g.1", "8.96.1.g.2", "8.96.1.h.1", "8.96.1.h.2", "8.96.1.i.1", "8.96.1.i.2", "8.96.1.j.1", "8.96.1.j.2", "8.96.1.k.1", "8.96.1.l.1", "8.96.1.l.2", "8.96.1.m.1",
"8.96.1.n.1", "9.12.1.a.1", "9.36.1.a.1", "9.36.1.b.1", "9.36.1.b.2", "9.36.1.c.1", "9.54.1.a.1", "9.81.1.a.1", "9.108.1.a.1", "9.108.1.a.2", "9.108.1.b.1", "11.12.1.a.1", "11.55.1.a.1", "11.55.1.b.1",
"11.60.1.a.1", "11.60.1.a.2", "11.60.1.b.1", "11.60.1.b.2", "11.60.1.c.1", "16.24.1.a.1", "16.24.1.b.1", "16.24.1.c.1", "16.24.1.d.1", "16.24.1.e.1", "16.24.1.e.2", "16.24.1.f.1", "16.24.1.f.2",
"16.24.1.g.1", "16.24.1.g.2", "16.24.1.h.1", "16.24.1.h.2", "16.24.1.i.1", "16.24.1.j.1", "16.24.1.k.1", "16.24.1.l.1", "16.24.1.m.1", "16.24.1.m.2", "16.24.1.n.1", "16.24.1.n.2", "16.48.1.a.1",
"16.48.1.a.2", "16.48.1.b.1", "16.48.1.b.2", "16.48.1.ba.1", "16.48.1.bb.1", "16.48.1.bc.1", "16.48.1.bd.1", "16.48.1.be.1", "16.48.1.bf.1", "16.48.1.bg.1", "16.48.1.bh.1", "16.48.1.bi.1", "16.48.1.bj.1",
"16.48.1.bk.1", "16.48.1.bl.1", "16.48.1.bm.1", "16.48.1.bn.1", "16.48.1.bo.1", "16.48.1.bp.1", "16.48.1.bq.1", "16.48.1.br.1", "16.48.1.bs.1", "16.48.1.bt.1", "16.48.1.bu.1", "16.48.1.bv.1",
"16.48.1.bw.1", "16.48.1.bx.1", "16.48.1.by.1", "16.48.1.bz.1", "16.48.1.c.1", "16.48.1.ca.1", "16.48.1.cb.1", "16.48.1.cc.1", "16.48.1.cd.1", "16.48.1.ce.1", "16.48.1.cf.1", "16.48.1.cg.1",
"16.48.1.ch.1", "16.48.1.ci.1", "16.48.1.ci.2", "16.48.1.cj.1", "16.48.1.cj.2", "16.48.1.ck.1", "16.48.1.ck.2", "16.48.1.cl.1", "16.48.1.cl.2", "16.48.1.cm.1", "16.48.1.cn.1", "16.48.1.co.1",
"16.48.1.cp.1", "16.48.1.cq.1", "16.48.1.cr.1", "16.48.1.cs.1", "16.48.1.ct.1", "16.48.1.cu.1", "16.48.1.cu.2", "16.48.1.cv.1", "16.48.1.cv.2", "16.48.1.cw.1", "16.48.1.cw.2", "16.48.1.cx.1",
"16.48.1.cx.2", "16.48.1.cy.1", "16.48.1.cz.1", "16.48.1.d.1", "16.48.1.da.1", "16.48.1.db.1", "16.48.1.dc.1", "16.48.1.dd.1", "16.48.1.de.1", "16.48.1.df.1", "16.48.1.e.1", "16.48.1.f.1",
"16.48.1.g.1", "16.48.1.h.1", "16.48.1.i.1", "16.48.1.j.1", "16.48.1.k.1", "16.48.1.l.1", "16.48.1.m.1", "16.48.1.n.1", "16.48.1.o.1", "16.48.1.p.1", "16.48.1.q.1", "16.48.1.q.2", "16.48.1.r.1",
"16.48.1.r.2", "16.48.1.s.1", "16.48.1.s.2", "16.48.1.t.1", "16.48.1.t.2", "16.48.1.u.1", "16.48.1.u.2", "16.48.1.v.1", "16.48.1.v.2", "16.48.1.w.1", "16.48.1.w.2", "16.48.1.x.1", "16.48.1.x.2",
"16.48.1.y.1", "16.48.1.z.1", "16.64.1.a.1", "16.64.1.b.1", "16.96.1.a.1", "16.96.1.a.2", "16.96.1.b.1", "16.96.1.b.2", "16.96.1.c.1", "16.96.1.c.2", "16.96.1.d.1", "16.96.1.d.2", "16.96.1.e.1",
"16.96.1.e.2", "16.96.1.f.1", "16.96.1.f.2", "16.96.1.g.1", "16.96.1.g.2", "16.96.1.h.1", "16.96.1.h.2", "16.96.1.i.1", "16.96.1.i.2", "16.96.1.j.1", "16.96.1.j.2", "16.96.1.k.1", "16.96.1.l.1",
"16.96.1.l.2", "16.96.1.m.1", "16.96.1.m.2", "16.96.1.n.1", "16.96.1.n.2", "16.96.1.o.1", "16.96.1.o.2", "16.96.1.p.1", "16.96.1.p.2", "16.96.1.q.1", "16.96.1.q.2", "16.96.1.r.1", "16.96.1.r.2",
"16.96.1.s.1", "16.96.1.s.2", "16.96.1.t.1", "17.18.1.a.1", "17.36.1.a.1", "17.36.1.a.2", "17.72.1.a.1", "17.72.1.a.2", "17.72.1.b.1", "17.72.1.b.2", "19.20.1.a.1", "19.60.1.a.1", "19.60.1.a.2",
"19.60.1.b.1", "27.36.1.a.1", "27.36.1.b.1", "27.108.1.a.1", "27.108.1.a.2", "27.108.1.b.1", "32.48.1.a.1", "32.48.1.a.2", "32.48.1.b.1", "32.48.1.b.2", "32.96.1.a.1", "32.96.1.a.2", "32.96.1.b.1",
"32.96.1.b.2", "32.96.1.c.1", "32.96.1.c.2", "32.96.1.d.1", "32.96.1.d.2", "32.96.1.e.1", "32.96.1.e.2", "32.96.1.f.1", "32.96.1.f.2", "32.96.1.g.1", "32.96.1.g.2", "32.96.1.h.1", "32.96.1.h.2",
"49.56.1.a.1"}

elliptic curves:={"7.42.1.b.1"
"7.56.1.a.1"
"7.56.1.b.1"
"7.84.1.a.1"
"8.12.1.a.1"
"8.12.1.b.1"
"8.12.1.c.1"
"8.12.1.d.1"
"8.24.1.a.1"
"8.24.1.b.1"
"8.24.1.ba.1"
"8.24.1.bb.1"
"8.24.1.bd.1"
"8.24.1.be.1"
"8.24.1.bf.1"
"8.24.1.c.1"
"8.24.1.d.1"
"8.24.1.f.1"
"8.24.1.l.1"
"8.24.1.m.1"
"8.24.1.n.1"
"8.24.1.o.1"
"8.24.1.r.1"
"8.24.1.s.1"
"8.24.1.t.1"
"8.24.1.u.1"
"8.24.1.w.1"
"8.24.1.x.1"
"8.24.1.y.1"
"8.48.1.bb.1"
"8.48.1.bc.1"
"8.48.1.bn.1"
"8.48.1.bp.1"
"8.48.1.bs.1"
"8.48.1.bv.1"
"8.48.1.c.1"
"8.48.1.g.1"
"8.48.1.g.2"
"8.48.1.h.1"
"8.48.1.h.2"
"8.48.1.i.1"
"8.48.1.i.2"
"8.48.1.k.1"
"8.48.1.k.2"
"8.48.1.m.1"
"8.48.1.m.2"
"8.48.1.n.1"
"8.48.1.p.1"
"8.48.1.t.1"
"8.96.1.d.1"
"8.96.1.e.2"
"8.96.1.f.2"
"8.96.1.g.1"
"8.96.1.g.2"
"8.96.1.j.1"
"8.96.1.l.1"
"8.96.1.m.1"
"9.12.1.a.1"
"9.36.1.a.1"
"9.36.1.b.1"
"9.36.1.b.2"
"9.36.1.c.1"
"9.54.1.a.1"
"9.108.1.a.1"
"9.108.1.a.2"
"9.108.1.b.1"
"11.12.1.a.1"
"11.55.1.a.1"
"11.55.1.b.1"
"11.60.1.a.1"
"11.60.1.a.2"
"11.60.1.b.1"
"11.60.1.b.2"
"11.60.1.c.1"
"16.24.1.a.1"
"16.24.1.b.1"
"16.24.1.c.1"
"16.24.1.d.1"
"16.24.1.e.1"
"16.24.1.e.2"
"16.24.1.f.1"
"16.24.1.f.2"
"16.24.1.g.1"
"16.24.1.g.2"
"16.24.1.h.1"
"16.24.1.h.2"
"16.24.1.i.1"
"16.24.1.j.1"
"16.24.1.k.1"
"16.24.1.l.1"
"16.24.1.m.1"
"16.24.1.m.2"
"16.24.1.n.1"
"16.24.1.n.2"
"16.48.1.a.1"
"16.48.1.a.2"
"16.48.1.b.1"
"16.48.1.b.2"
"16.48.1.ba.1"
"16.48.1.bd.1"
"16.48.1.bf.1"
"16.48.1.bg.1"
"16.48.1.bl.1"
"16.48.1.bm.1"
"16.48.1.bn.1"
"16.48.1.bo.1"
"16.48.1.bp.1"
"16.48.1.bq.1"
"16.48.1.br.1"
"16.48.1.bs.1"
"16.48.1.bt.1"
"16.48.1.bu.1"
"16.48.1.bv.1"
"16.48.1.ca.1"
"16.48.1.cc.1"
"16.48.1.cd.1"
"16.48.1.cf.1"
"16.48.1.cg.1"
"16.48.1.ch.1"
"16.48.1.cj.1"
"16.48.1.cj.2"
"16.48.1.cl.1"
"16.48.1.cl.2"
"16.48.1.cn.1"
"16.48.1.co.1"
"16.48.1.cp.1"
"16.48.1.cr.1"
"16.48.1.cs.1"
"16.48.1.ct.1"
"16.48.1.cv.1"
"16.48.1.cv.2"
"16.48.1.cx.1"
"16.48.1.cx.2"
"16.48.1.d.1"
"16.48.1.db.1"
"16.48.1.dc.1"
"16.48.1.de.1"
"16.48.1.df.1"
"16.48.1.g.1"
"16.48.1.h.1"
"16.48.1.i.1"
"16.48.1.k.1"
"16.48.1.p.1"
"16.48.1.q.1"
"16.48.1.q.2"
"16.48.1.r.1"
"16.48.1.r.2"
"16.48.1.t.1"
"16.48.1.t.2"
"16.48.1.u.1"
"16.48.1.u.2"
"16.48.1.v.1"
"16.48.1.v.2"
"16.48.1.x.1"
"16.48.1.x.2"
"16.48.1.y.1"
"16.96.1.b.1"
"16.96.1.b.2"
"16.96.1.c.2"
"16.96.1.e.2"
"16.96.1.f.1"
"16.96.1.f.2"
"16.96.1.g.1"
"16.96.1.l.2"
"16.96.1.m.1"
"16.96.1.m.2"
"16.96.1.q.1"
"17.18.1.a.1"
"17.36.1.a.1"
"17.36.1.a.2"
"17.72.1.a.1"
"17.72.1.a.2"
"17.72.1.b.1"
"17.72.1.b.2"
"19.20.1.a.1"
"19.60.1.a.1"
"19.60.1.a.2"
"19.60.1.b.1"
"27.36.1.a.1"
"27.36.1.b.1"
"27.108.1.a.1"
"27.108.1.a.2"
"32.48.1.a.1"
"32.48.1.a.2"
"32.48.1.b.1"
"32.48.1.b.2"
"32.96.1.a.1"
"32.96.1.a.2"
"32.96.1.b.1"
"32.96.1.d.1"
"32.96.1.d.2"
"32.96.1.e.1"
"32.96.1.f.1"
"32.96.1.f.2"
"32.96.1.h.1"
"49.56.1.a.1", "27.108.1.b.1"}

degree 2 map to P^1:={"7.42.1.a.1", "8.24.1.bc.1", "8.24.1.e.1", "8.24.1.g.1", "8.24.1.h.1", "8.24.1.i.1", "8.24.1.j.1", "8.24.1.k.1", "8.24.1.p.1", "8.24.1.q.1", "8.24.1.v.1", "8.24.1.z.1", 
                      "8.32.1.a.1", "8.32.1.b.1", "8.32.1.c.1", "8.32.1.d.1", "8.48.1.a.1", "8.48.1.b.1", "8.48.1.ba.1", "8.48.1.bd.1", "8.48.1.be.1", "8.48.1.bf.1", "8.48.1.bg.1", "8.48.1.bh.1",
                      "8.48.1.bh.2", "8.48.1.bj.1", "8.48.1.bk.1", "8.48.1.bl.1", "8.48.1.bm.1", "8.48.1.bo.1", "8.48.1.bq.1", "8.48.1.br.1", "32.96.1.g.2", "32.96.1.h.2", "32.96.1.g.1",      
                      "8.48.1.bt.1", "8.48.1.bu.1", "8.48.1.d.1", "8.48.1.e.1", "8.48.1.e.2", "8.48.1.f.1", "8.48.1.j.1", "8.48.1.l.1", "8.48.1.o.1", "8.48.1.q.1", "8.48.1.r.1", "8.48.1.s.1",
                      "8.48.1.s.2", "8.48.1.u.1", "8.48.1.v.1", "8.48.1.w.1", "8.48.1.x.1", "8.48.1.y.1", "8.48.1.z.1", "8.96.1.a.1", "8.96.1.a.2", "8.96.1.b.1", "8.96.1.b.2", "8.96.1.c.1",
                      "8.96.1.c.2", "8.96.1.e.1", "32.96.1.e.2", "32.96.1.c.2", "32.96.1.c.1", "32.96.1.b.2", "8.96.1.f.1", "8.96.1.h.1", "8.96.1.h.2", "8.96.1.i.1", "8.96.1.i.2", "8.96.1.j.2",
                      "8.96.1.k.1", "8.96.1.l.2", "8.96.1.n.1", "16.96.1.q.2", "16.96.1.r.1", "16.96.1.r.2", "16.96.1.s.1", "16.96.1.s.2", "16.48.1.bb.1", "16.48.1.bc.1", "16.48.1.be.1",
                      "16.48.1.bh.1", "16.48.1.bi.1", "16.48.1.bj.1", "16.48.1.bk.1", "16.48.1.bw.1", "16.48.1.bx.1", "16.48.1.by.1", "16.48.1.bz.1", "16.48.1.c.1", "16.48.1.cb.1", "16.48.1.ce.1",
                      "16.48.1.ci.1", "16.48.1.ci.2", "16.48.1.ck.1", "16.48.1.ck.2", "16.48.1.cm.1", "16.48.1.cq.1", "16.48.1.cu.1", "16.48.1.cu.2", "16.48.1.cw.1", "16.48.1.cw.2", "16.48.1.cy.1",
                      "16.48.1.cz.1", "16.48.1.da.1", "16.48.1.dd.1", "16.48.1.e.1", "16.48.1.f.1", "16.48.1.j.1", "16.48.1.m.1", "16.48.1.n.1", "16.48.1.o.1", "16.48.1.s.1", "16.48.1.s.2",
                      "16.48.1.w.1", "16.48.1.w.2", "16.48.1.z.1", "16.96.1.a.1", "16.96.1.a.2", "16.96.1.c.1", "16.96.1.d.1", "16.96.1.d.2", "16.96.1.e.1", "16.96.1.g.2", "16.96.1.h.1", "16.96.1.h.2",
                      "16.96.1.i.1", "16.96.1.i.2", "16.96.1.j.1", "16.96.1.j.2", "16.96.1.l.1", "16.96.1.n.1", "16.96.1.n.2", "16.96.1.o.1", "16.96.1.o.2", "16.96.1.p.1", "16.96.1.p.2"}     

remaining :={ "8.48.1.bi.1", "9.81.1.a.1", "16.96.1.t.1", "16.48.1.l.1", "16.64.1.a.1", "16.64.1.b.1", "16.96.1.k.1"} 

// 9.81.1.a.1
/* We show that it has no Q_3 points. */
// The function PointsViaLifting is due to David Zywina.
function PointsViaLifting(psi,p,m)
    /* Input:
            psi: a sequence of homogeneous polynomials in Z[x_1,...,x_r]
            p  : a prime
            m  : an integer at least one    
        Output:
            The set of points C(Z/p^m), where C is the subscheme of P^(r-1)_Q defined by psi.
    */    
    r:=Rank(Parent(psi[1]));
    PolZ<[x]>:=PolynomialRing(Integers(),r);
    psi:=[PolZ!f: f in psi];

    PP:=ProjectiveSpace(GF(p),r-1);
    C:=Scheme(PP,psi);
    S:={Eltseq(P): P in Points(C)};   // points mod p
    S:={[Integers()!a: a in P]: P in S};

    e:=1;
    while e lt m do
        PP:=ProjectiveSpace(Integers(p^(e+1)),r-1);
        Snew:={};        
        for P in S do
            // For each point in C(Z/p^e), we find all possible lifts to C(Z/p^(e+1)).
            A:=[]; b:=[];
            Pol<[a]>:=PolynomialRing(Integers(),r);
            for f in psi do
                pol:=Evaluate(f,[P[i]+p^e*a[i]: i in [1..r]]);
                A:=A cat [[MonomialCoefficient(pol,a[i]) div p^e : i in [1..r]]];
                b:=b cat [ -MonomialCoefficient(pol,1) div p^e ];
            end for;
            A:=ChangeRing(Matrix(A),GF(p));
            b:=ChangeRing(Vector(b),GF(p));
            flag,v,W:=IsConsistent(Transpose(A),b);
            if flag then 
                T:={Eltseq(v+w): w in W};
                T:={[Integers()!a: a in w] : w in T};
                T:={ [P[i]+p^e*w[i]: i in [1..r]] : w in T};
                T:={PP!w: w in T}; 
                Snew:=Snew join T;
            end if;
        end for;
        S:={Eltseq(P): P in Snew};
        S:={[Integers()!a: a in P]: P in S};
        e:=e+1;
    end while;

    S:={[Integers(p^m)!a: a in P] : P in S};
    return S;
end function;

P<x,y,z>:=PolynomialRing(Integers(),3);
Model:=[x^3 - 6*x^2*y + 3*x^2*z + 6*x*y*z - 6*x*z^2 - y^3 - 6*y*z^2 + z^3];
PointsViaLifting(Model,3,3);//empty

// "16.96.1.t.1" 
P<x,y,z,w> := PolynomialRing(Rationals(),4);
C := Curve(ProjectiveSpace(P),[-2*x*w + y^2 + 2*y*z - z^2, x^2 - 2*y^2 - 2*z^2 - 2*w^2]);
c := GenusOneModel(C);
c2 := DoubleGenusOneModel(c);
P<t> := PolynomialRing(Rationals());
c2;
f:=4*t^4 - 32;
g:=-4*t^2;
H := HyperellipticCurve(f,g);H;

IsLocallySolvable(H,2); // false

//"16.64.1.a.1"
P<x,y,z,w> := PolynomialRing(Rationals(),4);
C := Curve(ProjectiveSpace(P),[-2*x*w + 2*y^2 - z^2, x^2 - 4*x*w + 4*y*z + 4*z^2 + 2*w^2]);
c := GenusOneModel(C);
c2 := DoubleGenusOneModel(c);
P<t> := PolynomialRing(Rationals());
c2;
f:=8*t^4 - 112*t^2 - 64*t - 32;
g:=(-8*t - 16);
H := HyperellipticCurve(f,g);H;

IsLocallySolvable(H,2); //false

//"16.64.1.b.1"
P<x,y,z,w> := PolynomialRing(Rationals(),4);
C := Curve(ProjectiveSpace(P),[2*x*w + 2*y^2 - z^2, x^2 - 4*x*w - 4*y*z - 4*z^2 + 2*w^2]);
c := GenusOneModel(C);
c2 := DoubleGenusOneModel(c);
P<t> := PolynomialRing(Rationals());
c2;
f:=8*t^4 - 112*t^2 + 64*t - 32;
g:=(-8*t + 16);
H := HyperellipticCurve(f,g);H;

IsLocallySolvable(H,2);//false

//"16.96.1.k.1"

P<x,y,z,w> := PolynomialRing(Rationals(),4);
C := Curve(ProjectiveSpace(P),[2*x*w + y^2 + 2*y*z - z^2, x^2 + 2*y^2 + 2*z^2 - 2*w^2]);
c := GenusOneModel(C);
c2 := DoubleGenusOneModel(c);
P<t> := PolynomialRing(Rationals());
c2;
f:=4*t^4 - 32;
g:=4*t^2;
H := HyperellipticCurve(f,g);H;
IsLocallySolvable(H,2);//false
















