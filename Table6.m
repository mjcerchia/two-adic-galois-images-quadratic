//Code to verify Table 6

tab6:=[<"16.48.3.b.1","16.24.1.n.1">, <"16.48.3.bd.2","16.24.1.n.1">, <"16.48.3.b.2","16.24.1.n.2">, <"16.96.5.bd.2","16.48.1.cx.2">, <"16.48.3.bd.1","16.24.1.n.2">, <"16.96.5.bd.3","16.48.1.cx.1">, <"16.48.3.bg.1","16.24.1.n.1">, <"16.96.5.ca.1","16.48.1.cx.1">, <"16.48.3.n.1","16.24.1.n.1">, <"16.96.5.ca.2","16.48.1.cx.2">, <"16.96.3.ep.1","16.48.1.bl.1">, <"16.96.5.x.2","16.48.1.ct.1">, <"16.96.3.es.1","16.48.1.bn.1">, <"16.96.5.i.1","16.48.1.df.1">, <"16.96.3.et.1","16.48.1.cs.1">, <"16.96.5.ce.1","16.48.1.cx.2">, <"16.96.3.eu.1","16.48.1.bn.1">, <"16.96.5.ce.2","16.48.1.cx.1">, <"16.96.3.ev.1","16.48.1.bl.1">, <"16.96.5.i.2","16.48.1.cr.1">, <"16.96.3.ew.1","16.48.1.cs.1">, <"16.96.5.d.2","16.48.1.cs.1">, <"16.96.5.d.1","16.48.1.dc.1">, <"16.96.5.w.1","16.48.1.cx.1">, <"16.96.3.fd.1","16.48.1.bv.1">, <"16.96.5.w.2","16.48.1.cx.2">, <"16.96.3.ff.1","16.48.1.bv.1">, <"16.96.5.da.1","16.48.1.bn.1">, <"16.96.3.fg.1","16.48.1.dc.1">, <"16.96.5.db.1","16.48.1.bl.1">, <"16.96.3.fh.1","16.48.1.dc.1">, <"16.96.5.dd.1","16.48.1.bl.1">, <"16.96.3.fi.1","16.48.1.dc.1">, <"16.96.5.dg.1","16.48.1.bn.1">, <"16.96.3.eh.1","16.48.1.de.1">, <"16.96.5.dh.1","16.48.1.bv.1">, <"16.96.3.ei.1","16.48.1.df.1">, <"16.96.5.cq.1","16.48.1.dc.1">, <"16.96.3.ej.1","16.48.1.de.1">, <"16.96.5.cp.1","16.48.1.de.1">,
<"16.96.3.ek.1","16.48.1.df.1">, <"16.96.5.dn.1","16.48.1.bv.1">, <"16.96.3.fk.1","16.48.1.cf.1">, <"16.96.5.dq.1","16.48.1.cf.1">, <"16.96.3.fl.1","16.48.1.cg.1">, <"16.96.5.dr.1","16.48.1.cg.1">, <"16.96.3.fm.1","16.48.1.ch.1">, <"16.96.5.ds.1","16.48.1.ch.1">, <"16.96.3.fn.1","16.48.1.de.1">, <"16.96.4.k.1","16.48.1.ca.1">, <"16.96.3.fo.1","16.48.1.cf.1">, <"16.96.5.du.1","16.48.1.cf.1">, <"16.96.3.fp.1","16.48.1.cg.1">, <"16.96.5.dv.1","16.48.1.cg.1">, <"16.96.3.fq.1","16.48.1.ch.1">, <"16.96.5.dw.1","16.48.1.ch.1">, <"32.96.3.bh.1","16.48.1.bl.1">, <"32.96.5.bm.1","16.48.1.bq.1">, <"32.96.3.bi.1","16.48.1.bl.1">, <"32.96.5.bn.1","16.48.1.bq.1">, <"32.96.3.bj.1","16.48.1.bq.1">, <"32.96.5.bo.1","16.48.1.bv.1">, <"32.96.3.bk.1","16.48.1.bq.1">, <"32.96.5.bp.1","16.48.1.bv.1">, <"32.96.3.bl.1","16.48.1.bv.1">, <"32.96.5.bk.1","16.48.1.bl.1">, <"32.96.3.bm.1","16.48.1.bv.1">, <"32.96.5.bl.1","16.48.1.bl.1">, <"32.96.3.bx.1","16.48.1.cs.1">, <"32.96.5.bt.1","16.48.1.cs.1">, <"32.96.3.ca.1","16.48.1.dc.1">, <"32.96.5.bu.1","16.48.1.cs.1">, <"32.96.3.cb.1","16.48.1.de.1">, <"32.96.5.bv.1","16.48.1.dc.1">, <"32.96.3.cc.1","16.48.1.df.1">, <"32.96.5.by.1","16.48.1.dc.1">,
<"32.96.3.bn.1","16.48.1.cc.1">, <"32.96.5.bw.1","16.48.1.de.1">,
<"32.96.3.bo.1","16.48.1.cc.1">, <"32.96.5.bx.1","16.48.1.df.1">, <"32.96.3.bq.1","16.48.1.ch.1">, <"32.96.5.bz.1","16.48.1.de.1">, <"32.96.3.bs.1","16.48.1.ch.1">, <"32.96.5.ca.1","16.48.1.df.1">, <"32.96.3.bp.1","16.48.1.cg.1">, <"32.96.5.bj.1","16.48.1.ch.1">, <"32.96.3.br.1","16.48.1.cg.1">, <"32.96.5.bs.1","16.48.1.ch.1">, <"11.110.4.a.1","11.55.1.b.1">, <"32.96.5.bh.1","16.48.1.cc.1">, <"11.110.4.b.1","11.55.1.b.1">, <"32.96.5.bi.1","16.48.1.cg.1">, <"16.96.4.b.1","16.48.1.bq.1">, <"32.96.5.bq.1","16.48.1.cc.1">, <"16.96.4.c.1","16.48.1.bs.1">, <"32.96.5.br.1","16.48.1.cg.1">, <"16.96.4.e.1","16.48.1.bq.1">, <"32.96.7.be.1","16.48.1.cs.1">, <"16.96.4.h.1","16.48.1.bs.1">, <"32.96.7.bh.1","16.48.1.dc.1">, <"16.96.4.i.1","16.48.1.ca.1">, <"32.96.7.bi.1","16.48.1.de.1">, <"16.96.4.j.1","16.48.1.ca.1">, <"32.96.7.bj.1","16.48.1.df.1">, <"16.96.4.l.1","16.48.1.ca.1">, <"16.96.3.dc.1","16.48.1.bn.1">, <"16.96.4.m.1","16.48.1.cc.1">, <"16.96.3.dj.1","16.48.1.bs.1">, <"16.96.4.n.1","16.48.1.cc.1">, <"16.48.3.cc.1","16.24.1.n.2">, <"16.96.4.o.1","16.48.1.cc.1">, <"16.96.3.f.1","16.48.1.bs.1">, <"16.96.4.p.1","16.48.1.cc.1">, <"16.96.3.j.1","16.48.1.bn.1">, <"16.96.5.a.1","16.48.1.de.1">, <"16.48.3.bp.1","16.24.1.n.2">, <"16.96.5.bg.1","16.48.1.dc.1">, <"16.48.3.j.1","16.24.1.l.1">, <"16.96.5.bh.1","16.48.1.cr.1">, <"16.48.3.z.1","16.24.1.l.1">, <"16.96.5.bi.1","16.48.1.de.1">, <"16.48.3.bv.1","16.24.1.l.1">, <"16.96.5.bj.1","16.48.1.ct.1">, <"16.48.3.bv.2","16.24.1.l.1">, <"16.96.5.bs.1","16.48.1.cr.1">, <"16.96.3.be.1","16.48.1.ca.1">, <"16.96.5.bt.1","16.48.1.cs.1">, <"16.96.3.ex.1","16.48.1.cx.1">, <"16.96.5.bt.2","16.48.1.ct.1">, <"16.96.3.bp.1","16.48.1.cf.1">, <"16.96.5.bx.1","16.48.1.ct.1">, <"16.96.3.dn.1","16.48.1.cf.1">, <"16.96.5.by.1","16.48.1.cr.1">, <"16.96.3.do.1","16.48.1.ca.1">, <"16.96.5.ch.2","16.48.1.dc.1">, <"16.96.3.ex.2","16.48.1.cx.2">, <"16.96.5.ci.1","16.48.1.df.1">, <"16.96.3.ez.1","16.48.1.cx.2">, <"16.96.5.ci.2","16.48.1.de.1">, <"16.96.3.ez.2","16.48.1.cx.1">];


load "Genus 1 data_LMFDB.m";

Genus1LMFDBSubgroup := recformat<label:MonStgElt, gens:SeqEnum, H:GrpMat>;
Genus1LMFDBlist:=AssociativeArray();

for r in data do
    Genus1LMFDBlist[r[1]]:= rec<Genus1LMFDBSubgroup  | label:=r[1], gens:=r[3]>;
end for;


/* verifying that first entry in tab6 is an index 2 subgroup of second entry*/

for tuple in tab6 do;

level1:=StringToInteger(Split(tuple[1],".")[1]);
GL21:=GL(2,Integers(level1));
for x in data211 do;
if x[1] eq tuple[1] then
G1:=sub<GL21|x[4]>;
end if;
end for;

level2:=StringToInteger(Split(tuple[2],".")[1]);
GL22:=GL(2,Integers(level2));
G2:=sub<GL22|Genus1LMFDBlist[tuple[2]]`gens>;

pi:=hom<GL21->GL22|[GL22!GL21.i:i in [1..#Generators(GL21)]]>;
G2red:=G2@@pi;
m:=Integers()!(Order(G2red)/2);
bool:=[];
        for H in Subgroups(G2red:OrderEqual:=m) do;
        
        b,_:=IsConjugate(GL21,H`subgroup,G1);
        bool:=bool cat [b];
        
        end for;
assert true in bool;

end for;
//verifying that second tuple is an elliptic curve of rank 1

for tuple in tab6 do;

level2:=StringToInteger(Split(tuple[2],".")[1]);
GL22:=GL(2,Integers(level2));
G2:=sub<GL22|Genus1LMFDBlist[tuple[2]]`gens>;
G2t:=sub<GL22|[Transpose(GL22!g):g in Generators(G2)]>;
X:=CreateModularCurveRec(G2t);
XG:=FindModelOfXG(X);
D := Curve(ProjectiveSpace(Rationals(), Rank(Parent((XG`psi)[1]))-1),XG`psi);
Pts:=PointSearch(D,100);
E:=EllipticCurve(D,Pts[1]);
assert Rank(E) eq 1;

end for;
